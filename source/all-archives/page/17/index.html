<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="Hi!Roy!"><title>归档 - Hi!Roy!</title><meta name="author" content="Roy"><link rel="icon" href="http://www.hi-roy.com/assets/images/favicon.ico"><link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml"><meta property="og:type" content="blog"><meta property="og:title" content="Hi!Roy!"><meta property="og:url" content="http://www.hi-roy.com/source/all-archives/page/17/index.html"><meta property="og:site_name" content="Hi!Roy!"><meta property="og:locale" content="zh-cn"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Hi!Roy!"><meta property="og:image" content="http://www.hi-roy.com/assets/images/my.jpg"><link rel="stylesheet" href="/assets/css/style-sxklfps8ywgfyyjcowvnb4gxdgt0zjts3hsguljmv9uqanxjbnitrovtbrek.min.css"><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?21513ec2bcd577b3297a1b16da82fa40";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head><body><div id="blog"><header id="header" data-behavior="1"><i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i><div class="header-title"><a class="header-title-link" href="/">Hi!Roy!</a></div><a class="header-right-icon" href="#about"><i class="fa fa-lg fa-question"></i></a></header><nav id="sidebar" data-behavior="1"><div class="sidebar-container"><div class="sidebar-profile"><a href="/#about"><img class="sidebar-profile-picture" src="/assets/images/my.jpg" alt="作者的图片"></a><h4 class="sidebar-profile-name">Roy</h4><h5 class="sidebar-profile-bio"><p>君以国士待我，我必以国士报君。</p></h5></div><ul class="sidebar-buttons"><li class="sidebar-button"><a class="sidebar-button-link" href="/"><i class="sidebar-button-icon fa fa-lg fa-home"></i> <span class="sidebar-button-desc">首页</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="/all-categories"><i class="sidebar-button-icon fa fa-lg fa-bookmark"></i> <span class="sidebar-button-desc">分类</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="/all-tags"><i class="sidebar-button-icon fa fa-lg fa-tags"></i> <span class="sidebar-button-desc">标签</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="/all-archives"><i class="sidebar-button-icon fa fa-lg fa-archive"></i> <span class="sidebar-button-desc">归档</span></a></li><li class="sidebar-button"><a class="sidebar-button-link open-algolia-search" href="#search"><i class="sidebar-button-icon fa fa-lg fa-search"></i> <span class="sidebar-button-desc">搜索</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="#about"><i class="sidebar-button-icon fa fa-lg fa-question"></i> <span class="sidebar-button-desc">关于</span></a></li></ul><ul class="sidebar-buttons"><li class="sidebar-button"><a class="sidebar-button-link" href="https://github.com/shenyushun" target="_blank" rel="noopener"><i class="sidebar-button-icon fa fa-lg fa-github"></i> <span class="sidebar-button-desc">GitHub</span></a></li><li class="sidebar-button"><a class="sidebar-button-link" href="mailto:darkcooking@gmail.com" target="_blank" rel="noopener"><i class="sidebar-button-icon fa fa-lg fa-envelope-o"></i> <span class="sidebar-button-desc">邮箱</span></a></li></ul><ul class="sidebar-buttons"><li class="sidebar-button"><a class="sidebar-button-link" href="/atom.xml"><i class="sidebar-button-icon fa fa-lg fa-rss"></i> <span class="sidebar-button-desc">RSS</span></a></li></ul></div></nav><div id="main" data-behavior="1" class="hasCoverMetaIn"><section class="postShorten-group main-content-wrap"><article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemtype="http://schema.org/BlogPosting"><div class="postShorten-wrap"><div class="postShorten-header"><h1 class="postShorten-title" itemprop="headline"><a class="link-unstyled" href="/2014/06/01/64位kali安装skype/">64位kali安装skype</a></h1><div class="postShorten-meta"><time itemprop="datePublished" datetime="2014-06-01T08:36:23+08:00">6月 01, 2014 </time><span>发布在 </span><a class="category-link" href="/source/all-categories/Kali/">Kali</a></div></div><div class="postShorten-content" itemprop="articleBody"><p>参考了debian7的安装方式,首先运行:<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># dpkg --add-architecture i386</span></span><br><span class="line"><span class="comment"># apt-get update</span></span><br></pre></td></tr></table></figure><p></p><p>最初的时候64位系统是无法安装32位程序的。</p><p>然后安装相关依赖:<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get -f install</span><br></pre></td></tr></table></figure><p></p><p>下载32位skype并安装<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># wget -O skype-install.deb http://www.skype.com/go/getskype-linux-deb</span><br><span class="line"># dpkg -i skype-install.deb</span><br></pre></td></tr></table></figure><p></p><p><a href="/2014/06/01/64位kali安装skype/#post-footer" class="postShorten-excerpt_link link">评论和分享</a></p></div></div></article><article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemtype="http://schema.org/BlogPosting"><div class="postShorten-wrap"><div class="postShorten-header"><h1 class="postShorten-title" itemprop="headline"><a class="link-unstyled" href="/2014/05/15/Windows下的django批处理运行脚本/">Windows下的django批处理运行脚本</a></h1><div class="postShorten-meta"><time itemprop="datePublished" datetime="2014-05-15T12:03:58+08:00">5月 15, 2014 </time><span>发布在 </span><a class="category-link" href="/source/all-categories/Django/">Django</a></div></div><div class="postShorten-content" itemprop="articleBody"><p>回来半个月，终于抽出时间写点东西了。最近这天气真是让人不开心阿～不过昨天居然见到了彩虹，突然想起来在飞机上看见的彩虹是直立在太阳两边而不是桥形的，各有各的美感。</p><p>至于在win下如何安装python、setuptools、pip等网上很多这里不再重复，可是那些大小姐们向我反映说她们不会“运行cmd,输入python manage.py runserver”。正所谓收人钱财替人消灾，干脆写个批处理让她们双击运行算了，内容如下：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">python %cd%\manage.py runserver</span><br><span class="line">pause</span><br></pre></td></tr></table></figure><p></p><p>真是被微软“惯坏了”的孩子们阿….</p><p><a href="/2014/05/15/Windows下的django批处理运行脚本/#post-footer" class="postShorten-excerpt_link link">评论和分享</a></p></div></div></article><article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemtype="http://schema.org/BlogPosting"><div class="postShorten-wrap"><div class="postShorten-header"><h1 class="postShorten-title" itemprop="headline"><a class="link-unstyled" href="/2014/04/25/且行且珍惜/">且行且珍惜</a></h1><div class="postShorten-meta"><time itemprop="datePublished" datetime="2014-04-25T15:40:38+08:00">4月 25, 2014 </time><span>发布在 </span><a class="category-link" href="/source/all-categories/杂/">杂</a></div></div><div class="postShorten-content" itemprop="articleBody"><p>今天就是实习的最后一天了，做完了工作交接还真是清闲阿～祈祷明天是个好天气吧！！可千万不要像马航一样飞飞就消失了T_T。</p><p>也正因为清闲，所以看到了一个让我十分震惊的“小说”。突然后悔起来，怎么就没事瞎看，怎么就还全都看完了。有时候，无知真的是福气。</p><p>如果是几年之前的我看到这个，一定不会是现在这么冷静吧。这就是成长？不过真是没想到如此“曲折”的事情居然真的会发生，果然是艺术来源与生活阿！每个人都有自己选择未来之路的权力，最为一个旁观者，或许只能从文字之间去体会作者的情感了。</p><p>人生几十年，总是有人出现在我们的生命中，也总是有人消失在我们的生命中。从相识到相知再到最后的相离，其中掺杂了无数的苦辣酸甜，也正是这些构成了每个人不一样的回忆。我们无法控制何时相识、何时相离，或许想做到分离时“挥一挥衣袖，不带走一片云彩”，对别人来说却是“挥一挥衣袖，带走了整个天空”。分离时的撕心裂肺到几年、几十年后也云淡风轻了吧，或许还会成为大多数人不曾有过的回忆。</p><p>能够平静面对分离，真是一种境界。</p><p>最后，就像那句话说的——且行且珍惜（貌似这句话最近快被玩坏了？）。祝愿那些曾在生命中出现的过客安好。</p><p><a href="/2014/04/25/且行且珍惜/#post-footer" class="postShorten-excerpt_link link">评论和分享</a></p></div></div></article><article class="postShorten postShorten--thumbnailimg-right" itemscope itemtype="http://schema.org/BlogPosting"><div class="postShorten-wrap"><div class="postShorten-header"><h1 class="postShorten-title" itemprop="headline"><a class="link-unstyled" href="/2014/04/21/趣文：追MM的各种算法/">趣文：追MM的各种算法</a></h1><div class="postShorten-meta"><time itemprop="datePublished" datetime="2014-04-21T09:05:12+08:00">4月 21, 2014 </time><span>发布在 </span><a class="category-link" href="/source/all-categories/杂/">杂</a></div></div><div class="postShorten-excerpt" itemprop="articleBody"><p>转自：<a href="http://blog.jobbole.com/65500/" target="_blank" rel="noopener">http://blog.jobbole.com/65500/</a></p><h3 id="动态规划"><a href="#动态规划" class="headerlink" title="动态规划"></a>动态规划</h3><p>基本上就是说：你追一个MM的时候，需要对该MM身边的各闺中密友都好，这样你追MM这个问题就分解为对其MM朋友的问题，只有把这些问题都解决 了，最终你才能追到MM。因此，该问题适用于聪明的MM，懂得“看一个人，不是看他如何对你，而是看他如何对他人。”的道理，并且对付这样的MM总能得到 最优解。但确定是开销较大，因为每个子问题都要好好对待……</p><h3 id="贪心法"><a href="#贪心法" class="headerlink" title="贪心法"></a>贪心法</h3><p>基本上就是：你追一个MM的时候，从相识到相知，每次都采用最aggressive的方式，进攻进攻再进攻！从不采用迂回战术或是欲擒故纵之法！目标是以最快的速度确立两人的关系。该法优点是代价小，速度快，但缺点是不是每次都能得到最优解……、</p><h3 id="回溯算法"><a href="#回溯算法" class="headerlink" title="回溯算法"></a>回溯算法</h3><p>基本上就是：追一个MM，但也许你还是情窦初开的新手，不知道如何才能讨得MM的欢心，于 是你只好一条路一条路的试，MM不开心了，你就回溯回去换另一种方式。当然其间你也许会从某些途径得到一些经验，能够判断哪些路径不好，会剪枝（这就是分 支估界了）。你也可以随机选择一些路径来实施，说不定能立杆见影（这就是回溯的优化了）但总的来说，你都需要一场持久战……该算法一般也能得到最优解，因 为大多数MM会感动滴！！但其缺点是开销大除非你是非要谈一场恋爱不可，否则不推荐使用。特别是你可能还有许多其他的事情要做，比如学习，比如事业……</p><a href="/2014/04/21/趣文：追MM的各种算法/" class="postShorten-excerpt_link link">阅读全文</a></div></div></article><article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemtype="http://schema.org/BlogPosting"><div class="postShorten-wrap"><div class="postShorten-header"><h1 class="postShorten-title" itemprop="headline"><a class="link-unstyled" href="/2014/04/14/虚拟环境pycurl的import错误/">虚拟环境pycurl的import错误</a></h1><div class="postShorten-meta"><time itemprop="datePublished" datetime="2014-04-14T11:56:49+08:00">4月 14, 2014 </time><span>发布在 </span><a class="category-link" href="/source/all-categories/Python/">Python</a></div></div><div class="postShorten-content" itemprop="articleBody"><p>今天需要在虚拟环境下使用pycurl，使用pip安装时候没问题，不过再代码中import后则报错：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ImportError: pycurl: libcurl link-time ssl backend (nss) is different from compile-time ssl backend (none/other)</span><br></pre></td></tr></table></figure><p></p><p>解决方法：</p><ol><li>卸载pip uninstall pycurl</li><li>执行：export PYCURL_SSL_LIBRARY=nss</li><li>使用easy_install pycurl重新安装。</li></ol><p>转自<a href="http://www.tuicool.com/articles/qAFBvi" target="_blank" rel="noopener">http://www.tuicool.com/articles/qAFBvi</a></p><p><a href="/2014/04/14/虚拟环境pycurl的import错误/#post-footer" class="postShorten-excerpt_link link">评论和分享</a></p></div></div></article><article class="postShorten postShorten--thumbnailimg-right" itemscope itemtype="http://schema.org/BlogPosting"><div class="postShorten-wrap"><div class="postShorten-header"><h1 class="postShorten-title" itemprop="headline"><a class="link-unstyled" href="/2014/04/10/调试python程序/">调试python程序</a></h1><div class="postShorten-meta"><time itemprop="datePublished" datetime="2014-04-10T18:06:03+08:00">4月 10, 2014 </time><span>发布在 </span><a class="category-link" href="/source/all-categories/Python/">Python</a></div></div><div class="postShorten-excerpt" itemprop="articleBody"><p>怪不得这几天头疼的厉害，原来是发生了2件大事：官方的XP彻底和我们告别了and爆发了OpenSSL HeartBleed漏洞。这个漏洞可以说是一场大地震，不知道又会有多少网站被“扒光脱裤”，过一阵又得改密码玩了。面对这种网络安全问题，真的是一种待宰羔羊的无力感。</p><p>调试python程序我知道有3个东东：pdb,ipdb,pudb。</p><p>第一个是python自带模块，第二个如果安了ipython的话貌似自己就被安装了，最后一个有图形界面，十分复古的——蓝底，真是让人怀念。后2个都可以使用pip安装。<br>ipdb支持语法高亮，不过貌似中文支持不太好。</p><a href="/2014/04/10/调试python程序/" class="postShorten-excerpt_link link">阅读全文</a></div></div></article><article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemtype="http://schema.org/BlogPosting"><div class="postShorten-wrap"><div class="postShorten-header"><h1 class="postShorten-title" itemprop="headline"><a class="link-unstyled" href="/2014/04/09/python列表展开/">python列表展开</a></h1><div class="postShorten-meta"><time itemprop="datePublished" datetime="2014-04-09T16:27:16+08:00">4月 09, 2014 </time><span>发布在 </span><a class="category-link" href="/source/all-categories/Python/">Python</a></div></div><div class="postShorten-content" itemprop="articleBody"><p>某网站今年笔试题，本质就是把某多维数组变成一维数组并去重。本来要求用JS实现，不过用python更简洁一点，就是对列表进行展开操作，递归就KO了。</p><p>首先来个不简洁的：<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">arr = [<span class="number">1</span>, [<span class="number">1</span>, <span class="number">2</span>, [<span class="number">2</span>, <span class="number">3</span>]], [<span class="number">4</span>], [<span class="number">4</span>]]</span><br><span class="line">final=[]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"x is:"</span>,x</span><br><span class="line">    <span class="keyword">if</span> isinstance(x, list):</span><br><span class="line">        <span class="keyword">for</span> l <span class="keyword">in</span> x:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">"l is:"</span>,l</span><br><span class="line">            change(l)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        final.append(x)</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"now final is"</span>,final</span><br><span class="line">change(arr)</span><br><span class="line"><span class="keyword">print</span> final</span><br></pre></td></tr></table></figure><p></p><p>简洁的：<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">change = <span class="keyword">lambda</span> x: [y <span class="keyword">for</span> l <span class="keyword">in</span> x <span class="keyword">for</span> y <span class="keyword">in</span> change(l)] <span class="keyword">if</span> type(x) <span class="keyword">is</span> list <span class="keyword">else</span> [x]</span><br><span class="line"><span class="keyword">print</span> change(arr)</span><br></pre></td></tr></table></figure><p></p><p>至于去重就使用set()就可以了。</p><p><a href="/2014/04/09/python列表展开/#post-footer" class="postShorten-excerpt_link link">评论和分享</a></p></div></div></article><article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemtype="http://schema.org/BlogPosting"><div class="postShorten-wrap"><div class="postShorten-header"><h1 class="postShorten-title" itemprop="headline"><a class="link-unstyled" href="/2014/04/09/Mongodb初用记录/">Mongodb初用记录</a></h1><div class="postShorten-meta"><time itemprop="datePublished" datetime="2014-04-09T09:06:23+08:00">4月 09, 2014 </time><span>发布在 </span><a class="category-link" href="/source/all-categories/Linux/">Linux</a></div></div><div class="postShorten-content" itemprop="articleBody"><p>关于介绍以及缺点等网上介绍很多，这里记录一下我遇到的问题：</p><p>首先就是使用yum install安装后的mongodb无法设定开机启动。其次，即使修改了/etc/monggdb.conf文件的相关路径，运行时还必须手动指定dbpath参数才可运行。</p><p>于是按照官方指南说明的方法，添加了mongodb的源，安装yum install mongo-10gen mongo-10gen-server之后chkconfig mongod on才能设定成为开机启动。不过使用service mongod start启动、停止、重起服务会出现假死。但是不影响使用。</p><p>配置文件为：/etc/mongod.conf</p><p>初始化脚本为：/etc/rc.d/init.d/mongod</p><p>数据存储路径：/var/lib/mongo/</p><p>日志文件存储路径：/var/log/mongo/</p><p>守护进程运行用户为：mongod</p><p>任何数据最最基本的操作不外乎增删改查：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&gt; db.test.save(&#123;a:1&#125;)</span><br><span class="line">&gt; db.test.find()</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;530d3ec2d93e8e1410a1caf6&quot;), &quot;a&quot; : 1 &#125;</span><br><span class="line">&gt; doc = &#123;author:&apos;xsy&apos;,created: new Date(&apos;02/26/2014&apos;)&#125;</span><br><span class="line">&#123; &quot;author&quot; : &quot;xsy&quot;, &quot;created&quot; : ISODate(&quot;2014-02-25T16:00:00Z&quot;) &#125;</span><br><span class="line">&gt; db.test.insert(doc)</span><br><span class="line">&gt; db.test.find()</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;530d3ec2d93e8e1410a1caf6&quot;), &quot;a&quot; : 1 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;530d3f1ed93e8e1410a1caf7&quot;), &quot;author&quot; : &quot;xsy&quot;, &quot;created&quot; : ISODate(&quot;2014-02-25T16:00:00Z&quot;) &#125;</span><br><span class="line">&gt; db.test.update(&#123;author:&apos;xsy&apos;&#125;,&#123;$inc:&#123;check:400&#125;&#125;)</span><br><span class="line">&gt; db.test.find()</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;530d3ec2d93e8e1410a1caf6&quot;), &quot;a&quot; : 1 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;530d3f1ed93e8e1410a1caf7&quot;), &quot;author&quot; : &quot;xsy&quot;, &quot;check&quot; : 400, &quot;created&quot; : ISODate(&quot;2014-02-25T16:00:00Z&quot;) &#125;</span><br><span class="line">&gt; db.test.remove(&#123;a:1&#125;)删除</span><br><span class="line">&gt; db.test.find()</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;530d3f1ed93e8e1410a1caf7&quot;), &quot;author&quot; : &quot;xsy&quot;, &quot;check&quot; : 400, &quot;created&quot; : ISODate(&quot;2014-02-25T16:00:00Z&quot;) &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><p></p><p>更换数据库：默认情况下启动mongodb shell后自动使用的是test库，想换的话使用命令 use newname:<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; use mydb</span><br><span class="line">switched to db mydb</span><br><span class="line">&gt; db.mydb.save(&#123;a:2&#125;)</span><br><span class="line">&gt; db.test.find()</span><br><span class="line">&gt; db.mydb.find()</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;530d498ed93e8e1410a1caf8&quot;), &quot;a&quot; : 2 &#125;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><p></p><p>如上所示，当切换（或者说新建）数据库mydb后，再查询test数据是不显示的。而数据库目录下也多处了mydb.ns、mydb.0等相关文件。</p><p>看了增删改查的操作后，发现mongodb的操作更类似于编程语言，操作都是对于函数的调用，条件则是函数的参数。而且居然还支持正则表达式的查询方式，甚至for\foreach这两种循环都有。带$符号的则是关键字。</p><p>啊哈，mongodb的存储过程居然是用js写，书到用时方恨少阿！！真得抽时间学学JS了…</p><p>继续看，发现可以直接把文件存放在mongo数据库中，用到了gridfs。突然想起，mysql中有一种类型叫做blob，用于存放文件。</p><p>要在python中操作mongodb，需要一个pymongo,文档：<a href="http://api.mongodb.org/python/current/tutorial.html" target="_blank" rel="noopener">http://api.mongodb.org/python/current/tutorial.html</a></p><p><a href="/2014/04/09/Mongodb初用记录/#post-footer" class="postShorten-excerpt_link link">评论和分享</a></p></div></div></article><article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemtype="http://schema.org/BlogPosting"><div class="postShorten-wrap"><div class="postShorten-header"><h1 class="postShorten-title" itemprop="headline"><a class="link-unstyled" href="/2014/04/04/django自带的评论模块/">django自带的评论模块</a></h1><div class="postShorten-meta"><time itemprop="datePublished" datetime="2014-04-04T11:01:59+08:00">4月 04, 2014 </time><span>发布在 </span><a class="category-link" href="/source/all-categories/Django/">Django</a></div></div><div class="postShorten-content" itemprop="articleBody"><p>某个设计本来采用了一个比较不错的在线评论模块，不过答辩的时候丫居然不给网！！想偷个懒还是挺难啊….</p><p>那就用自带的评论模块吧，django版本是1.5.3。</p><p>首先把<code>&#39;django.contrib.comments&#39;</code>添加到INSTALLED_APPS中，然后添加url:<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">urlpatterns = patterns(<span class="string">''</span>,</span><br><span class="line">......</span><br><span class="line">url(<span class="string">r'^comments/'</span>, include(<span class="string">'django.contrib.comments.urls'</span>)),</span><br><span class="line">......</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p></p><p>在需要显示评论的HTML中：<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% load comments %&#125;</span><br><span class="line">&#123;% render_comment_list for post %&#125; &lt;!--显示所有属于这个文章的评论--&gt;</span><br><span class="line">&#123;% render_comment_form for post %&#125; &lt;!--显示自带的添加评论的form--&gt;</span><br></pre></td></tr></table></figure><p></p><p>不过自带的添加评论实在太丑了，我们可以自己改造一下：<br></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;% get_comment_form for post as form %&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">'&#123;%comment_form_target%&#125;'</span> <span class="attr">method</span>=<span class="string">'post'</span>&gt;</span></span><br><span class="line">    &#123;% csrf_token %&#125;</span><br><span class="line">    &#123;&#123;form.object_pk&#125;&#125;</span><br><span class="line">    &#123;&#123;form.content_type&#125;&#125;</span><br><span class="line">    &#123;&#123;form.timestamp&#125;&#125;</span><br><span class="line">    &#123;&#123;form.security_hash&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"id_name"</span>&gt;</span>姓名（必填）：<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">id</span>=<span class="string">"id_name"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"id_email"</span>&gt;</span>邮箱（必填）：<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"email"</span> <span class="attr">id</span>=<span class="string">"id_email"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"id_url"</span>&gt;</span>网站（可选）：<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">id</span>=<span class="string">"id_url"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"id_comment"</span>&gt;</span>评论（必填）：<span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">id</span>=<span class="string">"id_comment"</span> <span class="attr">rows</span>=<span class="string">"10"</span> <span class="attr">cols</span>=<span class="string">"40"</span> <span class="attr">name</span>=<span class="string">"comment"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"display:none;"</span>&gt;</span><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"id_honeypot"</span>&gt;</span>垃圾评论。<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"honeypot"</span> <span class="attr">id</span>=<span class="string">"id_honeypot"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"post"</span> <span class="attr">value</span>=<span class="string">"发表"</span> <span class="attr">type</span>=<span class="string">"submit"</span> /&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'hidden'</span> <span class="attr">name</span>=<span class="string">'next'</span> <span class="attr">value</span>=<span class="string">"/blog/post/&#123;&#123;post.id&#125;&#125;"</span>/&gt;</span> <span class="comment">&lt;!--这个是提交后的重定向，使用软编码总报错...--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><p>然后再进行CSS或者JS一类的特效美化就OK了。</p><p><a href="/2014/04/04/django自带的评论模块/#post-footer" class="postShorten-excerpt_link link">评论和分享</a></p></div></div></article><article class="postShorten postShorten--thumbnailimg-bottom" itemscope itemtype="http://schema.org/BlogPosting"><div class="postShorten-wrap"><div class="postShorten-header"><h1 class="postShorten-title" itemprop="headline"><a class="link-unstyled" href="/2014/04/01/django中由类实例引起的小坑/">django中由类实例引起的小坑</a></h1><div class="postShorten-meta"><time itemprop="datePublished" datetime="2014-04-01T11:38:13+08:00">4月 01, 2014 </time><span>发布在 </span><a class="category-link" href="/source/all-categories/Django/">Django</a></div></div><div class="postShorten-content" itemprop="articleBody"><p>自己封装了一个logging在django中使用，结果发现输出的时候总是重复输出，比如：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">DEBUG---- 2014/03/31 10:38:13:</span><br><span class="line">!!</span><br><span class="line">DEBUG---- 2014/03/31 10:38:13:</span><br><span class="line">!!</span><br><span class="line">DEBUG---- 2014/03/31 10:38:13:</span><br><span class="line">!!</span><br><span class="line">DEBUG---- 2014/03/31 10:38:13:</span><br><span class="line">!!</span><br><span class="line">DEBUG---- 2014/03/31 10:38:13:</span><br><span class="line">140091903388560</span><br><span class="line">DEBUG---- 2014/03/31 10:38:13:</span><br><span class="line">140091903388560</span><br><span class="line">DEBUG---- 2014/03/31 10:38:13:</span><br><span class="line">140091903388560</span><br><span class="line">DEBUG---- 2014/03/31 10:38:13:</span><br><span class="line">140091903388560</span><br></pre></td></tr></table></figure><p></p><p>可以看出，id都是一样的。而且我查了一下，正好4个地方引入了mylog。mylog的完整代码见以前日志，这里给出导致错误的原因：<br><code>self.logger = logging.getLogger(__name__)</code></p><p>简单测试：<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mlog = MyLog()</span><br><span class="line"><span class="keyword">print</span> id(mlog)</span><br><span class="line"><span class="keyword">print</span> id(mlog.logger)</span><br><span class="line">xmlog = MyLog()</span><br><span class="line"><span class="keyword">print</span> id(xmlog)</span><br><span class="line"><span class="keyword">print</span> id(xmlog.logger)</span><br></pre></td></tr></table></figure><p></p><p>结果如下：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">123456666</span><br><span class="line">123456789</span><br><span class="line">123457777</span><br><span class="line">123456789</span><br></pre></td></tr></table></figure><p></p><p>可以看出虽然类id不同，不过核心的logger却是一个。因为我们执行runserver后，<code>__name__</code>就确定为mylog了，所以不管我们引用的时候如何写，<code>__name__</code>不变则都指向了同一个logger。更简单的例子如下：<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: x = <span class="number">1</span></span><br><span class="line">In [<span class="number">2</span>]: y = <span class="number">1</span></span><br><span class="line">In [<span class="number">3</span>]: id(x)</span><br><span class="line">Out[<span class="number">3</span>]: <span class="number">11279464</span></span><br><span class="line">In [<span class="number">4</span>]: id(y)</span><br><span class="line">Out[<span class="number">4</span>]: <span class="number">11279464</span></span><br></pre></td></tr></table></figure><p></p><p>更细节的原因可以看《python源码分析》。</p><p>改起来就让<code>__name__</code>不一样就解决了。比如：</p><p><code>self.logger = logging.getLogger(str(uuid.uuid4()))</code></p><p><a href="/2014/04/01/django中由类实例引起的小坑/#post-footer" class="postShorten-excerpt_link link">评论和分享</a></p></div></div></article><div class="pagination-bar"><ul class="pagination"><li class="pagination-prev"><a class="btn btn--default btn--small" href="/source/all-archives/page/16/"><i class="fa fa-angle-left text-base icon-mr"></i> <span>上一页</span></a></li><li class="pagination-next"><a class="btn btn--default btn--small" href="/source/all-archives/page/18/"><span>下一页</span> <i class="fa fa-angle-right text-base icon-ml"></i></a></li><li class="pagination-number">第 17 页 共 23 页</li></ul></div></section><footer id="footer" class="main-content-wrap"><span class="copyrights">Copyrights &copy; 2019 Roy. All Rights Reserved.</span></footer></div></div><div id="about"><div id="about-card"><div id="about-btn-close"><i class="fa fa-remove"></i></div><img id="about-card-picture" src="/assets/images/my.jpg" alt="作者的图片"><h4 id="about-card-name">Roy</h4><div id="about-card-bio"><p>君以国士待我，我必以国士报君。</p></div><div id="about-card-job"><i class="fa fa-briefcase"></i><br><p>野生程序猿</p></div><div id="about-card-location"><i class="fa fa-map-marker"></i><br>China</div></div></div><div id="algolia-search-modal" class="modal-container"><div class="modal"><div class="modal-header"><span class="close-button"><i class="fa fa-close"></i></span> <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled"><span class="searchby-algolia-text text-color-light text-small">by</span> <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg"> </a><i class="search-icon fa fa-search"></i><form id="algolia-search-form"><input type="text" id="algolia-search-input" name="search" class="form-control input--large search-input" placeholder="Search "></form></div><div class="modal-body"><div class="no-result text-color-light text-center">没有找到文章</div><div class="results"><div class="media"><div class="media-body"><a class="link-unstyled" href="http://www.hi-roy.com/2013/02/12/Ubuntu下Gogant的简易破墙术/"><h3 class="media-heading">Ubuntu下Gogant的简易破墙术</h3></a><span class="media-meta"><span class="media-date text-small">2013年2月12日</span></span><div class="media-content hide-xs font-merryweather"></div></div><div style="clear:both"></div><hr></div><div class="media"><div class="media-body"><a class="link-unstyled" href="http://www.hi-roy.com/2013/10/31/python常用第三方库-转载/"><h3 class="media-heading">Python常用第三方库(转载)</h3></a><span class="media-meta"><span class="media-date text-small">2013年10月31日</span></span><div class="media-content hide-xs font-merryweather"></div></div><div style="clear:both"></div><hr></div><div class="media"><div class="media-body"><a class="link-unstyled" href="http://www.hi-roy.com/2013/11/01/fedora19安装ar8161网卡驱动/"><h3 class="media-heading">fedora19安装ar8161网卡驱动</h3></a><span class="media-meta"><span class="media-date text-small">2013年11月1日</span></span><div class="media-content hide-xs font-merryweather"></div></div><div style="clear:both"></div><hr></div><div class="media"><div class="media-body"><a class="link-unstyled" href="http://www.hi-roy.com/2013/11/01/fedora19源，rpmforge，fastestmirror/"><h3 class="media-heading">fedora19源，rpmforge，fastestmirror</h3></a><span class="media-meta"><span class="media-date text-small">2013年11月1日</span></span><div class="media-content hide-xs font-merryweather"></div></div><div style="clear:both"></div><hr></div><div class="media"><div class="media-body"><a class="link-unstyled" href="http://www.hi-roy.com/2013/11/01/python中如何自定义解析域名/"><h3 class="media-heading">python中如何自定义解析域名</h3></a><span class="media-meta"><span class="media-date text-small">2013年11月1日</span></span><div class="media-content hide-xs font-merryweather"></div></div><div style="clear:both"></div><hr></div><div class="media"><div class="media-body"><a class="link-unstyled" href="http://www.hi-roy.com/2013/11/01/django版本更换/"><h3 class="media-heading">django版本更换</h3></a><span class="media-meta"><span class="media-date text-small">2013年11月1日</span></span><div class="media-content hide-xs font-merryweather"></div></div><div style="clear:both"></div><hr></div><div class="media"><div class="media-body"><a class="link-unstyled" href="http://www.hi-roy.com/2013/11/01/django-groundwork个人1-5-3修改版/"><h3 class="media-heading">django-groundwork个人1.5.3修改版</h3></a><span class="media-meta"><span class="media-date text-small">2013年11月1日</span></span><div class="media-content hide-xs font-merryweather"></div></div><div style="clear:both"></div><hr></div><div class="media"><div class="media-body"><a class="link-unstyled" href="http://www.hi-roy.com/2013/11/01/fedora19美化/"><h3 class="media-heading">fedora19美化</h3></a><span class="media-meta"><span class="media-date text-small">2013年11月1日</span></span><div class="media-content hide-xs font-merryweather"></div></div><div style="clear:both"></div><hr></div><div class="media"><div class="media-body"><a class="link-unstyled" href="http://www.hi-roy.com/2013/11/01/装饰器/"><h3 class="media-heading">装饰器</h3></a><span class="media-meta"><span class="media-date text-small">2013年11月1日</span></span><div class="media-content hide-xs font-merryweather"></div></div><div style="clear:both"></div><hr></div><div class="media"><div class="media-body"><a class="link-unstyled" href="http://www.hi-roy.com/2013/11/01/SVN常用操作/"><h3 class="media-heading">SVN常用操作</h3></a><span class="media-meta"><span class="media-date text-small">2013年11月1日</span></span><div class="media-content hide-xs font-merryweather"></div></div><div style="clear:both"></div><hr></div></div></div><div class="modal-footer"><p class="results-count text-medium" data-message-zero="没有找到文章" data-message-one="找到 1 篇文章" data-message-other="找到 {n} 篇文章">找到 226 篇文章</p></div></div></div><div id="cover" style="background-image:url(/assets/images/cover.jpg)"></div><script src="/assets/js/script-ivwiy10zeb8fifc4swnhkwneuk64y53w2scmdmtp8thi9cqfxh31aowtroaz.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.14.1/moment-with-locales.min.js"></script><script src="//cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script><script>var algoliaClient=algoliasearch("51U8PIBLP6","16909d9ce1780cda71113841864e7aa8"),algoliaIndex=algoliaClient.initIndex("my-blog")</script></body></html>